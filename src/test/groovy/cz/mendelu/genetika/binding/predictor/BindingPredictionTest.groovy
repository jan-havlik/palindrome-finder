package cz.mendelu.genetika.binding.predictor

import cz.mendelu.genetika.genoms.Sequence

/**
 * Created by Jiří Lýsek on 14.12.2016.
 */
class BindingPredictionTest extends GroovyTestCase {

    private static final String INSTANCE = BindingPredictionTest.class.simpleName;

    void setUp() {

    }

    void tearDown() {

    }

    void "test decide palindrome in far range"() {
        Sequence s = new Sequence("CTGACGCGCCCTGTAGCGGCGCATTAAGCGCGGCGGGTGTGGTGGTTACGCGCAGCGTGACCGCTACACTTGCCAGCGCCCTAGCGCCCGCTCCTTTCGCTTTCTTCCCTTCCTTTCTCGCCACGTTCGCCGGCTTTCCCCGTCAAGCTCTAAATCGGGGGCTCCCTTTAGGGTTCCGATTTAGTGCTTTACGGCACCTCGACCCCAAAAAACTTGATTAGGGTGATGGTTCACGTAGTGGGCCATCGCCCTGATAGACGGTTTTTCGCCCTTTGACGTTGGAGTCCACGTTCTTTAATA".bytes);

        BindingPrediction bp1 = new BindingPrediction(s, 40, 20, 0);
        assert bp1.getSearchSequence().toString().equals("CTGACGCGCCCTGTAGCGGCGCATTAAGCGCGGCGGGTGTGGTGGTTACGCGCAGCGTGACCGCTACACTTGCCAGCGCCCTAGCGCCCGCTCCTTTCGCTTTCTTCCCTTCCTTTCTCGCCACGTTCGCCGGCTTTCCCCGTCAAGCTCTAAATCGGGG") == true;

        BindingPrediction bp2 = new BindingPrediction(s, 120, 20, 0);
        assert bp2.getSearchSequence().toString().equals("GCATTAAGCGCGGCGGGTGTGGTGGTTACGCGCAGCGTGACCGCTACACTTGCCAGCGCCCTAGCGCCCGCTCCTTTCGCTTTCTTCCCTTCCTTTCTCGCCACGTTCGCCGGCTTTCCCCGTCAAGCTCTAAATCGGGGGCTCCCTTTAGGGTTCCGATTTAGTGCTTTACGGCACCTCGACCCCAAAAAACTTGATTAGGGTGATGGTTCACGTAGTG") == true;

        BindingPrediction bp3 = new BindingPrediction(s, 250, 20, 0);
        assert bp3.getSearchSequence().toString().equals("TAAATCGGGGGCTCCCTTTAGGGTTCCGATTTAGTGCTTTACGGCACCTCGACCCCAAAAAACTTGATTAGGGTGATGGTTCACGTAGTGGGCCATCGCCCTGATAGACGGTTTTTCGCCCTTTGACGTTGGAGTCCACGTTCTTTAATA") == true;
    }

}
